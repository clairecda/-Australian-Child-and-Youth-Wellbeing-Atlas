#RENAMING COLUMNS
names(df3) <- c("SA2_CODE16", "calendar_year", "total_deaths", "total_births",
"crude_rate_per_1000")
#DF 4 --------------------------------------------------------------------------
df4 <- cleaning(path = "202211_ANCHDA_suppressed_cells_final.xlsx", sht = 6, range = "A2:G6159", col = T)
#REMOVING SA2_NAME
df4 <- df4[,-2]
#RENAMING COLUMNS
names(df4) <- c("SA3_CODE16", "calendar_year", "age_group","total_deaths",
"total_population_NMD","age_specific_rate_per_100,000")
# DF 5 -------------------------------------------------------------------------
df5 <- cleaning(path = "202211_ANCHDA_suppressed_cells_final.xlsx", sht = 7, range = "A30:E89", col = F)
#ADDING NATIONAL COLUMN
df5$Australia <- 0
#RENAMING COLUMNS
names(df5) <- c("irsd_quintiles","calendar_year", "total_deaths",
"total_population_NMD", "crude_rate_per_100,000", "Australia")
#CHANGING COLUMN ORDER
corder <- c("Australia", "irsd_quintiles","calendar_year", "total_deaths",
"total_population_NMD", "crude_rate_per_100,000")
df5 <- df5[,corder]
# DF 6 -------------------------------------------------------------------------
df6 <- cleaning(path = "202211_ANCHDA_suppressed_cells_final.xlsx", sht = 8, range = "A2:F6980", col = T)
#REMOVING SA2_NAME
df6 <- df6[,-2]
#RENAMING COLUMNS
names(df6) <- c("SA2_CODE16", "calendar_year", "total_deaths",
"total_population_NMD","crude_rate_per_100,000")
#DF 7 --------------------------------------------------------------------------
df7 <- cleaning(path = "202211_ANCHDA_suppressed_cells_final.xlsx", sht = 10, range = "A30:E89", col = F)
#ADDING NATIONAL COLUMN
df7$Australia <- 0
#RENAMING COLUMNS
names(df7) <- c("irsd_quintiles","calendar_year", "total_deaths",
"total_population_NMD", "crude_rate_per_100,000", "Australia")
#REORDERING COLUMNS
corder <- c("Australia", "irsd_quintiles","calendar_year", "total_deaths",
"total_population_NMD", "crude_rate_per_100,000")
df7 <- df7[,corder]
# DF 8 -------------------------------------------------------------------------
df8 <- cleaning(path = "202211_ANCHDA_suppressed_cells_final.xlsx", sht = 11, range =  "A2:F6980", col = T)
#REMOVING SA2_NAME
df8 <- df8[,-2]
#RENAMING COLUMNS
names(df8) <- c("SA2_CODE16", "calendar_year", "total_deaths",
"total_population_NMD","crude_rate_per_100,000")
# DF 9 -------------------------------------------------------------------------
df9 <- cleaning(path = "202211_ANCHDA_suppressed_cells_SA3_persons.xlsx", sht = 3, range = "A2:G3080", col = T )
#REMOVING SA2_NAME
df9 <- df9[,-2]
#RENAMING COLUMNS
names(df9) <- c("SA3_CODE16",  "calendar_year", "sex", "total_deaths",
"total_population_NMD","crude_rate_per_100,000")
# DF 10 ------------------------------------------------------------------------
df10 <- cleaning(path = "202211_ANCHDA_suppressed_cells_SA3_persons.xlsx", sht = 4, range = "A2:G3080", col = T)
#REMOVING SA2_NAME
df10 <- df10[,-2]
#RENAMING COLUMNS
names(df10) <- c("SA3_CODE16", "calendar_year", "sex", "total_deaths",
"total_population_NMD","age_specific_rate_per_100,000")
# ---------------------------- #
# --- MERGING BY INDICATOR --- #
# ---------------------------- #
# FILTERS ----------------------------------------------------------------------
# as per data dictionary, other NMD
SA3 <- c("SA3_CODE16", "calendar_year")
SA2 <- c("SA2_CODE16", "calendar_year")
Aus <- c("Australia", "calendar_year" )
age <- c("age_group")
sex <- c("sex")
irsd <- c("irsd_quintiles")
# 1.1.2 INFANT MORTALITY -------------------------------------------------------
infantmort <- c("total_deaths", "crude_rate_per_1000")
#infant mortality SA3
a <- df1[,c(SA3, infantmort)]
#infant mortality national, irsd
b <- df2[,c(Aus, irsd, infantmort)]
# infant mortality SA2
c <- df3[,c(SA2, infantmort)]
# 1.1.1O BIRTHS ----------------------------------------------------------------
birth <- c("total_births", "crude_rate_per_1000")
#births SA3
d <- df1[,c(SA3, birth)]
#infant births national, irsd
e <- df2[,c(Aus, irsd, birth)]
#infant mortality SA2
f <- df3[,c(SA2, birth)]
# 1.21.1 MORTALITY -------------------------------------------------------------
mort1.1 <- c("total_deaths", "total_population_NMD","age_specific_rate_per_100,000")
mort1.2 <- c("total_deaths", "total_population_NMD", "crude_rate_per_100,000")
#SA3 0-17 mortality, age
g <- df4[,c(SA3, age, mort1.1)]
#SA3 mortality 0-17, sex
m <- df9[,c(SA3, sex, mort1.2)]
#SA3 mortality 18-24, age group
n <- df10[,c(SA3, sex, mort1.1)]
# ------------------------------------------------------------------------------
#national mortality, irsd
h <- df5[,c(Aus, irsd, mort1.2)]
#national, irsd 18-24
j <- df7[,c(Aus, irsd, mort1.2)]
# ------------------------------------------------------------------------------
#SA2 mortality
i <- df6[,c(SA2, mort1.2)]
#SA2 mortality 18-24
k <- df8[,c(SA2, mort1.2)]
# MERGING TOGETHER ------------------------------------------------------------
#national mortality (0-24: 0-17, 18-24)
hj <- merge(h,j,by = intersect(names(h), names(j)), all.x = T)
#SA3 mortality (0-24: 0-17, 18-24)
gm <- merge(g,m,by = intersect(names(g), names(m)), all.x = T)
gmn <- merge(gm,n,by = intersect(names(gm), names(n)), all.x = T)
#SA2 mortality (0-24: 0-17, 18-24)
ik <- merge(i,k,by = intersect(names(i), names(k)), all.x = T)
# ----------------- #
# --- WRITE CSV --- #   RUN BY AIDEN AFTER FINAL CHECK WILL NEED BE MOVED INTO INTERIM FOLDER (WILL SAVE INTO RAW DATA)
# ----------------- #
# 1.1.2 INFANT MORTALITY CSVS
write.csv(a, "NMD_112_infant_mortality_SA3", row.names = F)
write.csv(b, "NMD_112_infant_mortality_National", row.names = F)
write.csv(c, "NMD_112_infant_mortality_SA2", row.names = F)
#
#
# # 1.1.1O BIRTHS CSVS
#
write.csv(d, "NMD_1110_infant_births_SA3", row.names = F)
write.csv(e, "NMD_1110_infant_births_National", row.names = F)
write.csv(f, "NMD_1110_infant_births_SA2", row.names = F)
#
#
# # 1.21.1 MORTALITY CSVS
#
write.csv(hj, "NMD_1211_mortality_National", row.names = F)
write.csv(gmn, "NMD_1211_mortality_SA3", row.names = F)
write.csv(ik, "NMD_1211_mortality_SA2", row.names = F)
#set working directory ---------------------------------------------------------
#---------------------------#
#--------libraries----------#
#---------------------------#
library(readxl)
library(dplyr)
#df1 = df1
#-------------------------------------#
#--------S-HSC_age_sex (df1)----------#
#-------------------------------------#
df1 <-read_excel(col_names = F, path = "Request 4958 SHSC ANCHDA Atlas ad hoc (1).xlsx",
sheet = 2,
range = "A3:F20106")
setwd("C:/Users/n9955348/OneDrive - Queensland University of Technology/Shared Documents - ACWA_QUT/General/Data_Collections_RAW/from_custodians/SHSC_SA3")
#set working directory ---------------------------------------------------------
#---------------------------#
#--------libraries----------#
#---------------------------#
library(readxl)
library(dplyr)
#df1 = df1
#-------------------------------------#
#--------S-HSC_age_sex (df1)----------#
#-------------------------------------#
df1 <-read_excel(col_names = F, path = "Request 4958 SHSC ANCHDA Atlas ad hoc (1).xlsx",
sheet = 2,
range = "A3:F20106")
colnames(df1) <- c("SA3_CODE16","SA3_NAME16","age_group","sex", "calendar_year", "client_count_SHSC")
df1$SA3_NAME16 <- NULL
#--------------------------------------------------#
#--------S-HSC_presenting_unit_type (df2)----------#
#--------------------------------------------------#
df2 <- read_excel(col_names = F, path = "Request 4958 SHSC ANCHDA Atlas ad hoc (1).xlsx",
sheet = 3,
range = "A3:F60314")
colnames(df2) <- c("SA3_CODE16","SA3_NAME16","age_group", "calendar_year", "presenting_unit_type_SHSC", "client_count_SHSC")
df2$SA3_NAME16 <- NULL
#-------------------------------------------------------------#
#--------S-HSC_main_reasons_seeking_assistance (df3)----------#
#-------------------------------------------------------------#
df3 <- read_excel(col_names = F, path = "Request 4958 SHSC ANCHDA Atlas ad hoc (1).xlsx",
sheet = 4,
range = "A3:F60314")
colnames(df3) <- c("SA3_CODE16","SA3_NAME16","age_group", "calendar_year", "main_reasons_seeking_assistance_SHSC", "client_count_SHSC")
df3$SA3_NAME16 <- NULL
#----------------------------------------#
#-------- merging by indicator ----------#
#----------------------------------------#
# merging by indicator ---------------------------------------------------------
# 2.9.1 housing amenity: homelessness ------------------------------------------
half <- merge(df1,df2,by = intersect(names(df1), names(df2)), all.x = T)
full <- merge(half,df3,by = intersect(names(half), names(df3)), all.x = T)
col_order <- c("SA3_CODE16","calendar_year", "age_group", "client_count_SHSC", "main_reasons_seeking_assistance_SHSC" , "presenting_unit_type_SHSC")
full <- full[,col_order]
#---------------------------#
#--------write csv----------#
#---------------------------#
write.csv(full291, file = "SHSC_191_homelessness_SA3", row.names = F)
write.csv(full, file = "SHSC_191_homelessness_SA3", row.names = F)
setwd("C:/Users/n9955348/OneDrive - Queensland University of Technology/ANCHDA_QUT/ANCHDA_Github_Harriette/custodian_data")
setwd("C:/Users/n9955348/OneDrive - Queensland University of Technology/ANCHDA_QUT/ANCHDA_Github_Harriette/custodian_data")
#HARRIETTES WD:
setwd("C:/Users/n9955348/OneDrive - Queensland University of Technology/Shared Documents - ACWA_QUT/General/Data_Collections_RAW/public_data/TableBuilder_Data/Schools/for ANCHDA")
#HARRIETTES WD:
setwd("C:/Users/n9955348/OneDrive - Queensland University of Technology/Shared Documents - ACWA_QUT/General/Data_Collections_RAW/public_data/TableBuilder_Data/Schools/for ANCHDA")
#path_out = "C:/Users/n9955348/OneDrive - Queensland University of Technology/Shared Documents - ACWA_QUT/General/Data_Collections_INTERIM"
# TO DO:
#
# STUDENTS - GOV, CATH, INDEP COL ONL, REMOVE GOV/NON GOV COLUMN - done
# RENTION RATES - ADD AGE GROUP AND KEEP YEAR LEVEL AS WELL - done
# FIND SOLUTION TO LESS THAN 4 AND GREATER THAN 21 - not done, need to consult methodology
# ----------------- #
# --- libraries --- #
# ----------------- #
library(readxl)
library(dplyr)
# ------------------------------ #
# --- reading in excel files --- #
# ------------------------------ #
cleaning <- function(path, sht, range, col, nems, corder){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col))
for(i in seq(3,ncol(df),1)){
if(!(names(df)[i] %in% c("Affiliation (Gov/Non-gov)","Affiliation (Gov/Cath/Ind)","Age", "Sex", "Affiliation", "Year Range", "Year (Grade)"))){
#NAS introduced in other columns but these are deleted anyway ;O
df[,i] <- as.numeric(df[,i])
df[,i] <- round(df[,i],1)
}
}
#CHANGE NAMES TO CODES
names(df)[names(df) == 'State/Territory'] <- 'STE'
if("STE" %in% names(df)){
df$STE <- recode(df$STE,
"a NSW" = 1,
"b Vic." = 2,
"c Qld" = 3,
"d SA" = 4,
"e WA" = 5,
"f Tas." = 6,
"g NT" = 7,
"h ACT" = 8,
"f Tas." = 6,
"i Aust." = 0)
#unique(df1$col) <- check above worked, col = col want checked
}
#CHANGE TO NOT AGE PREFIX/SUFFIX
if("Age" %in% names(df)){
df$Age <- recode(df$Age,
#DF1
"a 4 years and under" = "0-4",
"b 5 years" = "5",
"c 6 years" = "6",
"d 7 years" = "7",
"e 8 years" = "8",
"f 9 years" = "9",
"g 10 years" = "10",
"h 11 years" = "11",
"i 12 years" = "12",
"j 13 years" = "13",
"k 14 years" = "14",
"l 15 years" = "15",
"m 16 years" = "16",
"n 17 years" = "17",
"o 18 years" = "18",
"p 19 years" = "19",
"q 20 years" = "20",
"r 21 years and over" = "21 <", # change this to 21-x
#DF2
"a 14 Turning 15" = "14-15",
"b 15 Turning 16" = "15-16",
"c 16 Turning 17" = "16-17",
"d 17 Turning 18" = "17-18",
"e 18 Turning 19" = "18-19")
#unique(df1$col) <- check above worked, col = col want checked
}
#CHANGE NAMES TO CODES
names(df)[names(df) == 'Affiliation (Gov/Cath/Ind)'] <- "gov"
if("gov" %in% names(df)){
df$gov <- recode(df$gov,
"a Government" = "Government" ,
"b Catholic" = "Catholic" ,
"c Independent" = "Independent")
#unique(df1$col) <- check above worked, col = col want checked
}
#CHANGE Sex to not have prefix
if("Sex" %in% names(df)){
df$Sex <- recode(df$Sex,
"a Male" = "Male",
"b Female" = "Female",
"c Persons" = "Persons")
#unique(df1$col) <- check above worked, col = col want checked
}
return(df)
}
# ------------------------------- #
# --- cleaning individual dfs --- #
# ------------------------------- #
# School Attendance Rates ------------------------------------------------------
df1 <- cleaning (path = "Table 42bN_FT_andPT_Students, 2006-2022.xlsx",
sht = 3,
range = "A5:M77085",
col = T)
#REMOVING COLUMNS
df1 <- df1[, -c(3,6:9)]
#COLUMNS REMOVED: affiliation_gov_non_gov, Aboriginal and Torres Strait Islander Status,
#School Level, National Report on Schooling (ANR) School Level, Year (Grade)
names(df1) <- c("calendar_year", "STE_CODE16","affiliation_gov_cath_ind","sex",
"age_group", "full_time_student_count", "part_time_student_count", "total_abs_schools")
corder <- c("STE_CODE16", "calendar_year", "age_group", "sex", "affiliation_gov_cath_ind", "full_time_student_count", "part_time_student_count", "total_abs_schools")
df1 <- df1[,corder]
# School continuation Rates --------------------------------------------------
df2 <- cleaning (path = "Table 62a Capped Apparent Continuation Rates, 2011-2022.xlsx",
sht = 2,
range = "A5:E1625",
col = T)
names(df2) <- c("calendar_year", "STE_CODE16", "sex", "age_group", "apparent_continuation_rate")
corder <- c("STE_CODE16","calendar_year", "age_group","sex", "apparent_continuation_rate")
df2 <- df2[,corder]
# School retention Rates -----------------------------------------------------
df3 <- cleaning(path = "Table 63a_ARetention Rates_Single Year_grade.xlsx",
sht = 2,
range = "A5:H8105",
col = T)
#REMOVING COLUMNS
df3 <- df3[, -c(3,6)]
#COLUMNS REMOVED: "Affiliation" , "Aboriginal and Torres Strait Islander ARR"
names(df3) <- c("calendar_year", "STE_CODE16", "sex", "school_grade", "apparent_retention_rate", "total_rentention_rate")
df3$age_group <- NA
corder <- c("STE_CODE16", "calendar_year","sex", "age_group", "school_grade", "apparent_retention_rate", "total_rentention_rate")
df3 <- df3[,corder]
if("school_grade" %in% names(df3)){
df3$school_grade <- recode(df3$school_grade,
"a Year 7 - Year 8" = "Year 7 - Year 8",
"b Year 8 - Year 9" = "Year 8 - Year 9",
"c Year 9 - Year 10" = "Year 9 - Year 10",
"d Year 10 - Year 11" = "Year 10 - Year 11",
"e Year 11 - Year 12" = "Year 11 - Year 12")
#unique(df1$col) <- check above worked, col = col want checked
}
# Adding column based on other column:
df3 <- df3 %>%
mutate(age_group = case_when(
endsWith(school_grade, "8") ~ "13-14",
endsWith(school_grade, "9") ~ "14-15",
endsWith(school_grade, "10") ~ "15-16",
endsWith(school_grade, "11") ~ "16-17",
endsWith(school_grade, "12") ~ "17-18",
))
# -------------------------------------- #
# --- year 12 and year 5 attendance  --- #
# -------------------------------------- #
# YEAR 12 ---------------------------------------------------------------------
df4 <- cleaning (path = "Table 42bN_FT_andPT_Students, 2006-2022.xlsx",
sht = 3,
range = "A5:M77085",
col = T)
#REMOVING COLUMNS
df4 <- df4[, -c(3,6:8)]
#COLUMNS REMOVED: affiliation_gov_non_gov, Aboriginal and Torres Strait Islander Status,
#School Level, National Report on Schooling (ANR) School Level
names(df4) <- c("calendar_year", "STE_CODE16","affiliation_gov_cath_ind","sex", "school_grade",
"age_group", "full_time_student_count", "part_time_student_count", "total_abs_schools")
corder <- c("STE_CODE16", "calendar_year","sex", "age_group" , "school_grade", "affiliation_gov_cath_ind", "full_time_student_count", "part_time_student_count", "total_abs_schools")
df4 <- df4[,corder]
# ONLY YEAR 12 DATA
df4 <- df4[which(df4$school_grade == "o Year 12"),names(df4) %in% c("STE_CODE16", "calendar_year","sex", "age_group" , "school_grade", "affiliation_gov_cath_ind", "full_time_student_count", "part_time_student_count", "total_abs_schools")]
# unique(df4$school_grade) - confirm only grade level
if("school_grade" %in% names(df4)){
df4$school_grade <- recode(df4$school_grade,
"o Year 12" = "Year 12"
)
}
# YEAR 5 ---------------------------------------------------------------------
df5 <- cleaning (path = "Table 42bN_FT_andPT_Students, 2006-2022.xlsx",
sht = 3,
range = "A5:M77085",
col = T)
#REMOVING COLUMNS
df5 <- df5[, -c(3,6:8)]
#COLUMNS REMOVED: affiliation_gov_non_gov, Aboriginal and Torres Strait Islander Status,
#School Level, National Report on Schooling (ANR) School Level
names(df5) <- c("calendar_year", "STE_CODE16","affiliation_gov_cath_ind","sex", "school_grade",
"age_group", "full_time_student_count", "part_time_student_count", "total_abs_schools")
corder <- c("STE_CODE16", "calendar_year","sex", "age_group" , "school_grade", "affiliation_gov_cath_ind", "full_time_student_count", "part_time_student_count", "total_abs_schools")
df5 <- df5[,corder]
# ONLY YEAR 5 DATA
df5 <- df5[which(df5$school_grade == "f Year 5"),names(df5) %in% c("STE_CODE16", "calendar_year","sex", "age_group" , "school_grade", "affiliation_gov_cath_ind", "full_time_student_count", "part_time_student_count", "total_abs_schools")]
# unique(df5$school_grade) - confirm only grade level
if("school_grade" %in% names(df5)){
df5$school_grade <- recode(df5$school_grade,
"f Year 5" = "Year 5"
)
}
# ----------------- #
# --- write csv --- #
# ----------------- #
path_out = "C:/Users/n9955348/OneDrive - Queensland University of Technology/Shared Documents - ACWA_QUT/General/Data_Collections_INTERIM"
# write.csv(df1,paste(path_out,'ABS_schools_473_full_time_and_part_time_students_STE', sep = '', row.names = F))
# write.csv(df1, "ABS_schools_473_full_time_and_part_time_students_STE.csv", row.names = F)
# write.csv(df2, "ABS_schools_463_continuation_rates_STE.csv", row.names = F)
# write.csv(df3, "ABS_schools_461_retention_rate_STE.csv", row.names = F)
# write.csv(df3, "ABS_schools_462_school_completion_year_12.csv", row.names = F)
# write.csv(df3, "ABS_schools_Attendance_at_primary_school_Year_5_STE.csv", row.names = F)
# _____________________________________________________________________
#UNUSED CODE
#REVOMING UNWANTED CHARACTERS FROM WITHIN COLUMNS
# df$STE <- substr(df$STE,3,nchar(df$STE))
#
# df$Sex <- substr(df$Sex,3,nchar(df$Sex))
#
#  names(df1)[names(df1) == 'affiliation_gov_cath_ind'] <- "gov"
#df1$gov <- substr(df1$gov,3,nchar(df1$gov))
#
# names(df1)[names(df1) == 'Affiliation (Gov/Cath/Ind)'] <- "cath"
#
#
# df1$cath <- substr(df1$cath,3,nchar(df1$cath))
#
View(df1)
View(df2)
View(df3)
setwd("C:/Users/n9955348/OneDrive - Queensland University of Technology/Shared Documents - ACWA_QUT/General/Data_Collections_RAW/public_data/TableBuilder_Data/Births")
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
View(df1)
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
df[df[,] == "np"] <- NA
for(i in seq(3,ncol(df),2)){
df[,i] <- as.numeric(df[,i])
df[,i] <- round(df[,i],2)
}
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
df[df[,] == "np"] <- NA
# for(i in seq(3,ncol(df),2)){
#   df[,i] <- as.numeric(df[,i])
#   df[,i] <- round(df[,i],2)
# }
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
#df[df[,] == "np"] <- NA
# for(i in seq(3,ncol(df),2)){
#   df[,i] <- as.numeric(df[,i])
#   df[,i] <- round(df[,i],2)
# }
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
df[df[,] == "np"] <- NA
# for(i in seq(3,ncol(df),2)){
#   df[,i] <- as.numeric(df[,i])
#   df[,i] <- round(df[,i],2)
# }
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
#df[df[,] == "np"] <- NA
for(i in seq(3,ncol(df),2)){
df[,i] <- as.numeric(df[,i])
df[,i] <- round(df[,i],2)
}
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
cleaning <- function(path, sht, range){
#path = file path, sht = Sheet number, range = column range, col = col names
df <- as.data.frame(read_xlsx(path,
sht,
range,
col_names = T))
#df[df[,] == "np"] <- NA
# for(i in seq(3,ncol(df),2)){
#   df[,i] <- as.numeric(df[,i])
#   df[,i] <- round(df[,i],2)
# }
}
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 3, range = "A8:AS138")
View(df1)
df1 <- cleaning(path = "births_LGA_2011_2021.xlsx", sht = 2, range = "A8:AS138")
View(df1)
